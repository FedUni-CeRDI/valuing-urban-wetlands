import{a as E,m as x,b as P,c as O,o as i,d as u,r as _,e as a,f as w,g as H,S as L,h as T,F as q,l as c,V as N,i as $,G as g,T as I,j as z,M as X,O as K,k as Q,t as Y,n as R,p as f,P as Z,q as U,w as v,v as y,s as d,u as M,x as V,y as D,W as J,z as ee,A as W,B as G,C as te,D as ae,E as ne,H as se,I as oe}from"./vendor-0c87475f.js";window.axios=E;E.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const F={computed:{geoserverUrl(){return this.config.geoserver_base_url+"/geoserver/aurin/ows"}},methods:{getWfsFeatureInfo:function(e,t,n){const o=new URLSearchParams({service:"WFS",version:"2.0.0",featureId:n,request:"GetFeature",typeNames:e+":"+t,outputFormat:"application/json"});return this.geoserverUrl+"?"+o.toString()}}},m=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n},le={mixins:[F],data(){return{}},computed:{...x({wetlands:"wetlandNames"}),...x(["selectedWetland"])},methods:{...P(["storeWetland"])},mounted(){let e=this,t={sourceId:"wetlands",templates:{item({item:n}){return n.name}},getItems({query:n}){return e.wetlands.filter(function(o){return o.name.match(new RegExp(n,"i"))})},getItemInputValue({item:n}){return n.name},onSelect({item:n}){if(!e.selectedWetland||e.selectedWetland.getId()!=="wetlands."+n.id){const o=e.getWfsFeatureInfo("aurin","wetlands",n.id);e.storeWetland(o)}}};O({container:"#wetland-search",placeholder:"Search by Wetland Name",getSources({query:n}){return[t]}})}},re={id:"wetland-search"};function ie(e,t,n,o,s,l){return i(),u("div",re)}const ue=m(le,[["render",ie]]);function A(e,t){e.getView().fit(t,{padding:[50,50,50,50]})}function j(e){return e.getId().split(".")[1]}const ce={methods:{zoomToFullExtent(e){return A(e,e.get("MAP_EXTENT"))}},components:{WetlandSearch:ue},props:["protectionStatus","map"],emits:["update:protectionStatus"],mounted(){}},de={class:"map-controls"},pe={class:"row justify-content-center align-items-center"},he={class:"col-auto"},me=a("i",{class:"bi bi-arrows-angle-expand"},null,-1),fe=[me],_e={class:"col-auto"},Se={class:"col-auto"},be={class:"form-floating"},we=["value"],ge=H('<option value="Conservation Park">Conservation Park</option><option value="Heritage River">Heritage River</option><option value="Natural Catchment Area">Natural Catchment Area</option><option value="Nature Conservation Reserve">Nature Conservation Reserve</option><option value="Natural Features Reserve">Natural Features Reserve</option><option value="National Park">National Park</option><option value="Private Nature Reserve">Private Nature Reserve</option><option value="Ramsar">Ramsar Site</option><option value="Reference Area">Reference Area</option><option value="State Park">State Park</option><option value="Other">Other</option><option value="none">No protection</option><option value="any">Any protection</option><option value="all">No Filter</option>',14),ve=[ge],ye=a("label",{for:"protectionStatus"},"Filter by protection status",-1);function Ce(e,t,n,o,s,l){const p=_("WetlandSearch");return i(),u("div",de,[a("form",null,[a("div",pe,[a("div",he,[a("button",{class:"btn btn-sm btn-light",type:"button",onClick:t[0]||(t[0]=h=>l.zoomToFullExtent(n.map))},fe)]),a("div",_e,[w(p)]),a("div",Se,[a("div",be,[a("select",{class:"form-select","aria-label":"Filter by protection status",name:"protection_status",id:"protectionStatus",value:n.protectionStatus,onInput:t[1]||(t[1]=h=>e.$emit("update:protectionStatus",h.target.value))},ve,40,we),ye])])])])])}const We=m(ce,[["render",Ce]]),xe=new L({stroke:new T({color:"#3f3f3f",width:2}),fill:new q({color:"rgba(255,184,0,0.6)"})}),Ae=[144.1168836932806,-38.56752038512003,146.16343402067832,-37.2082605301041],Pe={components:{MapControls:We},data(){return{sidebar:null,wetlandName:"",layers:{wetlands:null,selected:null},viewparams:{wetlands:{protection:"all"}},map:null}},computed:{...x(["selectedWetland"])},mixins:[F],methods:{buildViewParams(e){return c.reduce(e,function(t,n,o){return t=(t!==""?t+",":t)+o+":"+n,t},"")},updateProtectionStatus(e){this.viewparams.wetlands.protection=e;let t=this.layers.wetlands.getSource();t.updateParams(c.merge(t.getParams(),{VIEWPARAMS:this.buildViewParams(this.viewparams.wetlands)}))},selectFeature(e){let t=this;const n=t.layers.wetlands.getSource().getFeatureInfoUrl(e.coordinate,t.map.getView().getResolution(),"EPSG:3857",{INFO_FORMAT:"application/json"});this.storeWetland(n)},renderSelectedFeature(e){let t=this;t.layers.selected.getSource().clear(),e&&(t.layers.selected.getSource().addFeature(e),A(t.map,e.getGeometry().getExtent()),t.pushWetlandInfoRoute(e))},pushWetlandInfoRoute(e){let t=j(e);t!==this.$route.params.id&&this.$router.push({name:"wetland-report",params:{id:t}})},pushHomeRoute(){this.$router.push({name:"intro"})},...P(["storeWetland"])},watch:{selectedWetland(e){e?this.pushWetlandInfoRoute(e):this.pushHomeRoute(),this.renderSelectedFeature(e)}},mounted(){let e=this;const t=new N({source:new $({url:e.geoserverUrl+"?service=WFS&version=1.1.0&request=GetFeature&typeName=aurin:mw_boundary_simplified&outputFormat=application/json",format:new g}),style:new L({stroke:new T({color:"#000",width:"1"})})});e.layers.wetlands=new I({source:new z({url:e.geoserverUrl,params:{LAYERS:"aurin:wetlands",TILED:!0,VIEWPARAMS:this.buildViewParams(this.viewparams.wetlands)}})}),e.layers.selected=new N({source:new $({}),style:xe}),e.map=new X({target:"map",layers:[new I({source:new K}),t,this.layers.wetlands,this.layers.selected],view:new Q({center:[0,0],zoom:2})}),e.map.set("MAP_EXTENT",Y(Ae,"EPSG:7844","EPSG:3857")),A(e.map,e.map.get("MAP_EXTENT")),e.map.on("singleclick",e.selectFeature)}},Fe={class:"col-4 sidebar"},ke={class:"col-8 viewport"},Ne={id:"viewport"},$e=a("div",{id:"map"},null,-1);function Ie(e,t,n,o,s,l){const p=_("router-view"),h=_("MapControls");return i(),u(f,null,[a("div",Fe,[(i(),R(p,{name:"sidebar",key:e.$route.path,feature:e.selectedWetland},null,8,["feature"]))]),a("div",ke,[a("div",Ne,[w(h,{protectionStatus:this.viewparams.wetlands.protection,"onUpdate:protectionStatus":l.updateProtectionStatus,map:s.map},null,8,["protectionStatus","onUpdate:protectionStatus","map"]),$e])])],64)}const Ee=m(Pe,[["render",Ie]]),Le={name:"SidebarXhrContent",data(){return{content:"Loading ..."}},watch:{},computed:{contentPath(){return this.$route.name?"/content/"+this.$route.name:null}},mounted(){const e=this;e.contentPath&&axios.get(e.contentPath).then(function(t){e.content=t.data}).then(function(){var t=[].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));t.map(function(n){return new Z(n)})})}},Te=["innerHTML"];function Re(e,t,n,o,s,l){return i(),u("div",{innerHTML:s.content},null,8,Te)}const b=m(Le,[["render",Re]]);const Ue={props:["landUseData","index"],data(){return{showAllData:!1}},methods:{toggleTable(){this.showAllData=!this.showAllData},showDataRow(e){return e===0||this.showAllData}},mounted(){let e=[],t=this,n=t.landUseData;c.forEach(n.data,function(s){let l={name:s.usage,hoverinfo:"name",x:[],y:[n.label],type:"bar",orientation:"h"};l.x.push(s.percentage),e.push(l)});let o=t.$el.getElementsByClassName("landUseChart")[0];U.newPlot(o,e,{showlegend:!1,margin:{t:0,b:0,l:0,r:0,pad:0},barmode:"stack",height:20,yaxis:{zeroline:!1,showgrid:!1,visible:!1},xaxis:{visible:!1,range:[0,100]}},{displayModeBar:!1,responsive:!0})}},Me=a("i",{class:"bi bi-clipboard-data"},null,-1),Ve=[Me],De=a("div",{class:"landUseChart"},null,-1),Ge={class:"landUseTable"},je={class:"table"},Be={class:"text-end"};function Oe(e,t,n,o,s,l){return i(),u("div",null,[v(a("button",{type:"button",class:"btn btn-sm float-end",onClick:t[0]||(t[0]=p=>l.toggleTable())},Ve,512),[[y,n.landUseData.data.length>1]]),a("h3",null,d(n.landUseData.label),1),De,a("div",Ge,[a("table",je,[(i(!0),u(f,null,M(n.landUseData.data,(p,h)=>v((i(),u("tr",null,[a("td",null,d(p.usage),1),a("td",Be,d(p.percentage),1)],512)),[[y,l.showDataRow(h)]])),256))])])])}const He=m(Ue,[["render",Oe]]);const qe={props:["seasonalCounts","showChart","index"],data(){return{chartTitle:"Latham's Snipe Project Counts By Season"}},methods:{drawSeasonalCountsChart(){let e=[],t=this,n={x:[],y:[],type:"bar",orientation:"v"};t.seasonalCounts.forEach(function(s){n.x.push(s.season),n.y.push(s.count)}),e.push(n);let o=t.$el.getElementsByClassName("seasonalCountChart")[0];U.newPlot(o,e,{showlegend:!1,margin:{t:0,l:20,r:30,pad:0},autosize:!0,height:400},{displayModeBar:!1,responsive:!0})}},mounted(){this.drawSeasonalCountsChart()}},ze=e=>(V("data-v-d4579635"),e=e(),D(),e),Xe=ze(()=>a("div",{class:"seasonalCountChart"},null,-1)),Ke=[Xe];function Qe(e,t,n,o,s,l){return i(),u("div",null,Ke)}const Ye=m(qe,[["render",Qe],["__scopeId","data-v-d4579635"]]);const Ze={name:"WetlandReport",components:{SeasonalCountsChart:Ye,LandUseChart:He},props:["feature","id"],mixins:[F],data(){return{landuseEndpointMap:{"Vicmap Planning Zones":"planning/zones","Vicmap Planning Overlays":"planning/overlays","VLUIS Property Classification":"vluis/property","VLUIS Land Use":"vluis/alum","VLUIS Land Cover":"vluis/landcover","Catchment Land use":"catchment"},stateAbbreviations:{Victoria:"vic",Queensland:"qld","New South Wales":"nsw",Tasmania:"tas","Australian Capital Territory":"act","Northern Territory":"nt","Western Australia":"wa","South Australia":"sa"},content:"",alaWaterbirdSpecies:null,alaFrogSpecies:null,landuse:[],snipe:{seasonalCounts:[],alaSeasonalCounts:[]},showSeasonalCountChart:!1,showAlaSeasonalCountChart:!1}},watch:{feature(e){e&&this.renderWetlandInfo(e)}},computed:{wetlandName(){return this.feature.get("name")},protectionStatus(){return this.feature===null||!this.feature.get("protection_status")?"Unknown":this.feature.get("protection_status")[0]===null?"None":this.feature.get("protection_status").join(", ")},featureStateAbbreviations(){return c.values(c.pick(this.stateAbbreviations,this.feature.get("states")))},threatenedAlaWaterbirdSpecies(){let e=this;return e.alaWaterbirdSpecies?c.filter(e.alaWaterbirdSpecies,function(t){let n=["aus",...e.featureStateAbbreviations],o=Object.keys(t.conservation);return c.intersection(n,o).length>0}):null},threatenedAlaFrogSpecies(){let e=this;return e.alaFrogSpecies?c.filter(e.alaFrogSpecies,function(t){let n=["aus",...e.featureStateAbbreviations],o=Object.keys(t.conservation);return c.intersection(n,o).length>0}):null},maxSnipeSeasonCount(){return this.snipe.seasonalCounts.length>0?c.maxBy(this.snipe.seasonalCounts,e=>parseInt(e.count)):null},maxSnipeAlaSeasonCount(){return this.snipe.alaSeasonalCounts.length>0?c.maxBy(this.snipe.alaSeasonalCounts,e=>parseInt(e.count)):null},maxSnipeSeasonLabel(){let e="?";return this.snipe.seasonalCounts.length>0&&(e="No data",this.maxSnipeSeasonCount&&(e=this.maxSnipeSeasonCount.season+": "+this.maxSnipeSeasonCount.count)),e},maxSnipeAlaSeasonLabel(){let e="?";return this.snipe.alaSeasonalCounts.length>0&&(e="No data",this.maxSnipeAlaSeasonCount&&(e=this.maxSnipeAlaSeasonCount.season+": "+this.maxSnipeAlaSeasonCount.count)),e}},methods:{featureToWkt(e,t){let n={featureProjection:"EPSG:3857"};return typeof t<"u"&&(n.dataProjection="EPSG:"+t),new J().writeFeature(e,n)},bufferedFeature(e){let t=.35,n=e.clone();n.getGeometry().transform("EPSG:3857","EPSG:7844");let o=new g().writeFeatureObject(n),s=ee(o,t,{units:"kilometers"});return s=new g().readFeature(s),s.getGeometry().transform("EPSG:7844","EPSG:3857"),s},fetchAlaWaterbirds(e){let t=this;e?axios.post("/app/area/ala-birds",{wkt:t.featureToWkt(e,7844)}).then(function(n){t.alaWaterbirdSpecies=n.data}):t.alaWaterbirdSpecies=null},fetchAlaFrogs(e){let t=this;e?axios.post("/app/area/ala-frogs",{wkt:t.featureToWkt(e,7844)}).then(function(n){t.alaFrogSpecies=n.data}):t.alaFrogSpecies=null},fetchLandUsage(e){let t=this;t.landuse.length=0,e&&c.forIn(t.landuseEndpointMap,(n,o)=>{t.fetchLandUsePercentage(e,o,n)})},async fetchLandUsePercentage(e,t,n){let o=this;await axios.post("/app/landuse/"+n,{wkt:o.featureToWkt(o.bufferedFeature(e),7844)}).then(function(s){o.landUsePushAndSort({label:t,data:s.data})})},landUsePushAndSort(e){let t=this;t.landuse.push(e),t.landuse=c.sortBy(t.landuse,"label")},async fetchLathamsSnipeSeasonalCounts(e){let t=this;t.snipe.seasonalCounts.length=0,e&&(t.snipe.seasonalCounts=await axios.post("/app/snipe/seasonal-counts",{wkt:t.featureToWkt(e,7844)}).then(function(n){return n.data}))},async fetchSnipeAlaSeasonalCounts(e){let t=this;t.snipe.alaSeasonalCounts.length=0,e&&(t.snipe.alaSeasonalCounts=await axios.post("/app/snipe/ala-seasonal-counts",{wkt:t.featureToWkt(e,7844)}).then(function(n){return n.data}))},renderWetlandInfo(e){this.fetchAlaWaterbirds(e),this.fetchAlaFrogs(e),this.fetchLathamsSnipeSeasonalCounts(e),this.fetchSnipeAlaSeasonalCounts(e),this.fetchLandUsage(e)},...P(["storeWetland"])},mounted(){const e=this;if(e.feature&&j(e.feature)===e.id)e.renderWetlandInfo(e.feature);else{const t=e.getWfsFeatureInfo("aurin","wetlands",e.id);e.storeWetland(t)}}},r=e=>(V("data-v-cf4b7a0c"),e=e(),D(),e),Je=r(()=>a("h1",null,"Wetland Values Report",-1)),et=r(()=>a("p",null," The wetland values report tool provides a summary of the waterbird diversity at a selected wetland. Dominant land uses are reported within 350m of the wetland boundary. ",-1)),tt={class:"table"},at=r(()=>a("td",null,"Wetland name",-1)),nt=r(()=>a("td",null,"Protection Status",-1)),st=r(()=>a("h2",null,"ALA Records",-1)),ot={class:"table"},lt=r(()=>a("td",null,"Number of waterbird species",-1)),rt=r(()=>a("td",null,"Number of threatened waterbird species",-1)),it=r(()=>a("td",null,"Number of frog species",-1)),ut=r(()=>a("td",null,"Number of threatened frog species",-1)),ct=r(()=>a("h2",null,"Latham's snipe data",-1)),dt=r(()=>a("p",null," Latham's Snipe is a mysterious migratory waterbird (shorebird) that is cryptic in its plumage and behaviour. This means it is often overlooked in monitoring and assessment. As a result, its wetland habitats are frequently threatened by land use change. ",-1)),pt={class:"table"},ht=r(()=>a("td",null,"Maximum number of Latham's Snipe",-1)),mt=r(()=>a("i",{class:"bi bi-bar-chart"},null,-1)),ft=[mt],_t={key:0},St={colspan:"3"},bt=r(()=>a("td",null,"Maximum number of Latham's Snipe (ALA)",-1)),wt=r(()=>a("i",{class:"bi bi-bar-chart"},null,-1)),gt=[wt],vt={key:1},yt={colspan:"3"},Ct=r(()=>a("h2",null,"Land use",-1)),Wt=r(()=>a("p",null," The built environment surrounding a wetland will influence its value for biodiversity. A wetland surrounded by housing or industry may provide less habitat for wetland birds than a wetland located near other wetlands. But it may also provide a refuge for birds transiting through an urban landscape. ",-1)),xt={class:"table"},At={key:0},Pt=r(()=>a("td",null,"?",-1)),Ft=[Pt],kt={key:1},Nt={colspan:"2"},$t={class:"w-100"},It=r(()=>a("thead",null,[a("tr",null,[a("th",null,"Source / Primary classification"),a("th",null,"%")])],-1)),Et={colspan:"2"};function Lt(e,t,n,o,s,l){const p=_("seasonal-counts-chart"),h=_("land-use-chart");return i(),u(f,null,[Je,et,n.feature?(i(),u(f,{key:0},[a("table",tt,[a("tbody",null,[a("tr",null,[at,a("td",null,d(l.wetlandName),1)]),a("tr",null,[nt,a("td",null,d(l.protectionStatus),1)])])]),st,a("table",ot,[a("tbody",null,[a("tr",null,[lt,a("td",null,d(s.alaWaterbirdSpecies==null?"?":s.alaWaterbirdSpecies.length),1)]),a("tr",null,[rt,a("td",null,d(l.threatenedAlaWaterbirdSpecies==null?"?":l.threatenedAlaWaterbirdSpecies.length),1)]),a("tr",null,[it,a("td",null,d(s.alaFrogSpecies==null?"?":s.alaFrogSpecies.length),1)]),a("tr",null,[ut,a("td",null,d(l.threatenedAlaFrogSpecies==null?"?":l.threatenedAlaFrogSpecies.length),1)])])]),ct,dt,a("table",pt,[a("tbody",null,[a("tr",null,[ht,a("td",null,d(l.maxSnipeSeasonLabel),1),a("td",null,[v(a("button",{type:"button",class:"btn btn-sm float-end",onClick:t[0]||(t[0]=S=>s.showSeasonalCountChart=!s.showSeasonalCountChart)},ft,512),[[y,s.snipe.seasonalCounts.length&&l.maxSnipeSeasonCount]])])]),s.showSeasonalCountChart?(i(),u("tr",_t,[a("td",St,[w(p,{"seasonal-counts":s.snipe.seasonalCounts,index:1},null,8,["seasonal-counts"])])])):W("",!0),a("tr",null,[bt,a("td",null,d(l.maxSnipeAlaSeasonLabel),1),a("td",null,[v(a("button",{type:"button",class:"btn btn-sm float-end",onClick:t[1]||(t[1]=S=>s.showAlaSeasonalCountChart=!s.showAlaSeasonalCountChart)},gt,512),[[y,s.snipe.alaSeasonalCounts.length&&l.maxSnipeAlaSeasonCount]])])]),s.showAlaSeasonalCountChart?(i(),u("tr",vt,[a("td",yt,[w(p,{"seasonal-counts":s.snipe.alaSeasonalCounts,index:2},null,8,["seasonal-counts"])])])):W("",!0)])]),Ct,Wt,a("table",xt,[a("tbody",null,[s.landuse.length?(i(),u("tr",kt,[a("td",Nt,[a("table",$t,[It,(i(!0),u(f,null,M(s.landuse,(S,B)=>(i(),u("tbody",null,[a("tr",null,[a("td",Et,[(i(),R(h,{landUseData:S,key:S.label,index:B},null,8,["landUseData","index"]))])])]))),256))])])])):(i(),u("tr",At,Ft))])])],64)):W("",!0)],64)}const Tt=m(Ze,[["render",Lt],["__scopeId","data-v-cf4b7a0c"]]);G.defs("EPSG:7844","+proj=longlat +ellps=GRS80 +no_defs +type=crs");te(G);const Rt=ae({history:ne(),routes:[{path:"/",name:"intro",components:{sidebar:b}},{path:"/about",name:"about",components:{sidebar:b}},{path:"/terms",name:"terms",components:{sidebar:b}},{path:"/contact",name:"contact",components:{sidebar:b}},{path:"/wetland/:id",name:"wetland-report",components:{sidebar:Tt},props:!0}]}),k=se({state(){return{selectedWetland:null,speciesInfo:null,wetlandNames:[]}},mutations:{storeWetlandNames(e,t){e.wetlandNames=t},selectWetland(e,t){let n=null;t!==null&&(["protection_status","states"].forEach(function(s){t.properties[s]=JSON.parse(t.properties[s])}),n=new g().readFeature(t)),e.selectedWetland=n},updateSpeciesInfo(e,t){e.speciesInfo=t}},actions:{async storeWetland(e,t){let n=await axios.get(t).then(function(o){let s=null;return o.data.features.length&&(s=o.data.features[0]),s});e.commit("selectWetland",n)}}});axios.get("/app/wetlands").then(function(e){k.commit("storeWetlandNames",e.data)});axios.get("/app/species-info").then(function(e){k.commit("updateSpeciesInfo",e.data)});const C=oe({components:{"map-viewport":Ee}});C.config.globalProperties.config=await axios.get("/app/config").then(function(e){return e.data});C.use(k);C.use(Rt);C.mount("#app");
